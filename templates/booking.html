{% extends 'base.html' %}

{% block title %}Booking{% endblock %}

{% block css %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">

<style>
    body, .section-title, .table {
        font-family: 'Poppins', sans-serif;
    }
    .section-title {
        font-weight: 600;
        font-size: 28px;
        margin-bottom: 20px;
        color: #343a51;
    }
    .table {
        font-size: 16px;
    }
    .btn {
        font-size: 14px;
        padding: 6px 12px;
        border-radius: 6px;
    }
    .name-font {
        font-family: 'Itim', cursive;
        font-size: 18px;
    }
</style>
{% endblock %}

{% block body %}

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{category}} alert-dismissible fade show">
                <i class="fas fa-info-circle"></i> {{ message }}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<div class="container mt-4">
    <h2 class="section-title">Booking Details</h2>

    <table class="table table-striped table-hover table-bordered">
        <thead class="thead-light">
            <tr>
                <th>PID</th>
                <th>Email</th>
                <th>Name</th>
                <th>Gender</th>
                <th>Slot</th>
                <th>Disease</th>
                <th>Date</th>
                <th>Time</th>
                <th>Department</th>
                <th>Phone</th>
                <th>Edit</th>
                <th>Delete</th>
                <th>Attended</th>

            </tr>
        </thead>

        <tbody>
            {% for post in query %}
            <tr>
                <td>{{ post.pid }}</td>
                <td>{{ post.email }}</td>
                <td class="name-font">{{ post.name }}</td>
                <td>{{ post.gender }}</td>
                <td>{{ post.slot }}</td>
                <td>{{ post.disease }}</td>
                <td>{{ post.date }}</td>
                <td>{{ post.time }}</td>
                <td>{{ post.dept }}</td>
                <td>{{ post.number }}</td>

                <td>
                    <a href="/edit/{{ post.pid }}" class="btn btn-success btn-sm">
                        <i class="fas fa-edit"></i>
                    </a>
                </td>

                <td>
                    <a href="/delete/{{ post.pid }}" class="btn btn-danger btn-sm"
                       onclick="return confirm('Delete this booking?');">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                </td>

                <td>
                      <a href="/attend/{{ post.pid }}" 
                         class="btn btn-primary btn-sm"
                         onclick="return confirm('Mark this patient as attended?');">
                         Attended
                      </a>
                </td>

            </tr>
            {% endfor %}
        </tbody>

    </table>
</div>

{% endblock %}
